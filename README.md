# spring-boot-kotlin-keycloak-demo

### Things todo list:

1. Clone this repository: `git clone https://github.com/hendisantika/spring-boot-kotlin-keycloak-demo.git`
2. Navigate to the folder: `cd spring-boot-kotlin-keycloak-demo`
3. Run Keycloak Container using Docker Compose
4. Import keycloak realm file

Get Token for Admin User Role

```shell
curl --location --request POST 'http://localhost:8080/auth/realms/PowerRanger/protocol/openid-connect/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--data-urlencode 'client_id=springboot-keycloak' \
--data-urlencode 'grant_type=password' \
--data-urlencode 'username=admin' \
--data-urlencode 'password=Naruto2022' \
--data-urlencode 'client_secret=yMRo7Pva3gIaXYgYqZESU5c3wcUeorMB'
```

Access URL for Admin Role

```shell
curl --location --request GET 'http://localhost:8888/api/example/admin' \
--header 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJHdDM5SUl2dUFBOGNXWVdCRG1KRnhROUFuMG9CMjRDMVdXYjM5bGlIS1o4In0.eyJleHAiOjE2NTI4NDM2MjYsImlhdCI6MTY1Mjg0MzAyNiwianRpIjoiZDEwZDhhMDQtOTRiNi00ZDc5LTgxMzAtYjQwZGYwMjJiMTNmIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2F1dGgvcmVhbG1zL1Bvd2VyUmFuZ2VyIiwiYXVkIjpbImxvZ2luLWFwcCIsImFjY291bnQiXSwic3ViIjoiZmY4ZTgxMjQtMjBiZC00ZDViLThjODYtNTBiODY2ZGJkM2IxIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoic3ByaW5nYm9vdC1rZXljbG9hayIsInNlc3Npb25fc3RhdGUiOiI4YTA4YmU3MC04YjY3LTRlMjYtODM5ZS1mNDczYWE3Zjc3N2IiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJBRE1JTiIsInVtYV9hdXRob3JpemF0aW9uIiwidXNlciIsImRlZmF1bHQtcm9sZXMtcG93ZXJyYW5nZXIiXX0sInJlc291cmNlX2FjY2VzcyI6eyJsb2dpbi1hcHAiOnsicm9sZXMiOlsidXNlciJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwic2lkIjoiOGEwOGJlNzAtOGI2Ny00ZTI2LTgzOWUtZjQ3M2FhN2Y3NzdiIiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJuYW1lIjoiQWRtaW4gVXNlciIsInByZWZlcnJlZF91c2VybmFtZSI6ImFkbWluIiwiZ2l2ZW5fbmFtZSI6IkFkbWluIiwiZmFtaWx5X25hbWUiOiJVc2VyIiwiZW1haWwiOiJhZG1pbkB5b3BtYWlsLmNvbSJ9.GY3C5QN6NW2MohZ8DuTvB9zY-6kFr7rhhFge_oMxKanY5RF4IT-UgQjxeyE-LDhifSnLMxrAiTw_hxha6nU3UvIpF7_CuY9LNZwJPE9BD2N_MJZKeXdEYGbbKagKPMqzoF_kx6AFKrVD389q-L28C47pdC9jFdgmZko3KNfhF_95ES7lnCvR49jwQQpT1LvdH7fJWGz2ffYt01__uIcZPnkdGnyRrIfEMHQN0iHZRGM8dJYqYFbkR8kXPDjq8qeXGH4Y6Zx4RolVc4slphjYLxfgYMnEG0ddwETrFBBxiMvJ5RqDidaJ3RQt_8vofiotvjNqB2a-6TRpWBQ5bDZCBQ' \
--header 'Cookie: JSESSIONID=9251C46CFE32EC52D8A82B91F5A3311C' \
--data-raw ''
```

Get Token for User Role

```shell
curl --location --request POST 'http://localhost:8080/auth/realms/PowerRanger/protocol/openid-connect/token' \
--header 'Content-Type: application/x-www-form-urlencoded' \
--header 'Cookie: JSESSIONID=9251C46CFE32EC52D8A82B91F5A3311C.unknown-host; JSESSIONID=9251C46CFE32EC52D8A82B91F5A3311C' \
--data-urlencode 'client_id=springboot-keycloak' \
--data-urlencode 'grant_type=password' \
--data-urlencode 'username=user' \
--data-urlencode 'password=Naruto2022' \
--data-urlencode 'client_secret=yMRo7Pva3gIaXYgYqZESU5c3wcUeorMB'
```

Access URL for Admin Role

```shell
curl --location --request GET 'http://localhost:8888/api/example' \
--header 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJHdDM5SUl2dUFBOGNXWVdCRG1KRnhROUFuMG9CMjRDMVdXYjM5bGlIS1o4In0.eyJleHAiOjE2NTI4NDQzNTcsImlhdCI6MTY1Mjg0Mzc1NywianRpIjoiYWJjMTZlOWItZjEwNS00YTg2LWI5MzktZDhiNzNmYTY0Mjg3IiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo4MDgwL2F1dGgvcmVhbG1zL1Bvd2VyUmFuZ2VyIiwiYXVkIjpbImxvZ2luLWFwcCIsImFjY291bnQiXSwic3ViIjoiYTFkMTQ1NDYtZWJmZi00NDg2LTljM2YtNGEzNjNiYWU0NTlkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoic3ByaW5nYm9vdC1rZXljbG9hayIsInNlc3Npb25fc3RhdGUiOiIyZTc4MmM3MS0xMWFhLTQxYWUtOTY4Yy1iMjZhODY2MjI5ZWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiIsIlVTRVIiLCJ1c2VyIiwiZGVmYXVsdC1yb2xlcy1wb3dlcnJhbmdlciJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImxvZ2luLWFwcCI6eyJyb2xlcyI6WyJ1c2VyIl19LCJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJzaWQiOiIyZTc4MmM3MS0xMWFhLTQxYWUtOTY4Yy1iMjZhODY2MjI5ZWUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsIm5hbWUiOiJVc2VyIFJvbGUiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ1c2VyIiwiZ2l2ZW5fbmFtZSI6IlVzZXIiLCJmYW1pbHlfbmFtZSI6IlJvbGUiLCJlbWFpbCI6InVzZXJAeW9wbWFpbC5jb20ifQ.GfRQr4QHk9B7S0X6K9o4iO41T6egt2cJqUBcTtU3rC_dBOt0_oMhrjcAirHw9fc_jQWclQ6bubrX1vfGxBxWPh4SlYEyU0UfR4-vzhLdoQSQrQ3yQP7C05zC0lebg2EgMDdFfTK6ZfRLjx7wbAWpBvNkZgsihXinUQfpzgRsvFIvLO999PPQWCCl47ae1zNwHf3G_UnQuPVeQ-0z0-7qcIi9IIhG1oUKBbM1oPICm1dsL4K8OiYsUqparJsWh_hxnZzwoahZZqTO5f8lvPKqK5CNFbEEA0t0cp3NK8gFFpHBxhgzgG5HombcNhZM89xAVB72E1ez7snnKqWgrj1SvA' \
--header 'Cookie: JSESSIONID=9251C46CFE32EC52D8A82B91F5A3311C' \
--data-raw ''
```